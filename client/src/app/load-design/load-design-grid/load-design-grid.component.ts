import { Component, Input, OnInit } from '@angular/core';
import { exportDataGrid } from 'devextreme/excel_exporter';
import { Workbook } from 'exceljs';
import { ILoadDesign } from 'src/app/shared/models/loadDesign';
import { saveAs } from 'file-saver-es';

@Component({
  selector: 'app-load-design-grid',
  templateUrl: './load-design-grid.component.html',
  styleUrls: ['./load-design-grid.component.scss']
})
export class LoadDesignGridComponent implements OnInit {

  @Input() loadDesignList: ILoadDesign[] = [];

  constructor() { }

  ngOnInit(): void {

  }


  onExporting(e: any): void {
    const workbook = new Workbook();
    const worksheet = workbook.addWorksheet("Load Design");

    exportDataGrid({
      component: e.component,
      worksheet,
      autoFilterEnabled: true
    }).then(() => {
      workbook.xlsx.writeBuffer().then(buffer => {
        saveAs(
          new Blob([buffer], { type: 'application/octet-stream' }),
          'LoadDesign.xlsx'
        );
      });
    })

    e.cancel = true;
  }

}
