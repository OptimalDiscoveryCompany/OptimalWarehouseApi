"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[487],{5487:(ut,_,l)=>{l.r(_),l.d(_,{TypeAddressModule:()=>dt});var y=l(6895),O=l(2171),f=l(1669),d=l(4006),H=l(7579);const A={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let T;const E=new Uint8Array(16);function z(){if(!T&&(T=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!T))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return T(E)}const c=[];for(let o=0;o<256;++o)c.push((o+256).toString(16).slice(1));const U=function L(o,i,e){if(A.randomUUID&&!i&&!o)return A.randomUUID();const n=(o=o||{}).random||(o.rng||z)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,i){e=e||0;for(let a=0;a<16;++a)i[e+a]=n[a];return i}return function C(o,i=0){return(c[o[i+0]]+c[o[i+1]]+c[o[i+2]]+c[o[i+3]]+"-"+c[o[i+4]]+c[o[i+5]]+"-"+c[o[i+6]]+c[o[i+7]]+"-"+c[o[i+8]]+c[o[i+9]]+"-"+c[o[i+10]]+c[o[i+11]]+c[o[i+12]]+c[o[i+13]]+c[o[i+14]]+c[o[i+15]]).toLowerCase()}(n)};var t=l(4650),N=l(4766),G=l(529);let x=(()=>{class o{constructor(e){this.http=e,this.baseUrl=N.N.rpwebAPI}savePositionType(e){return this.http.post(`${this.baseUrl}/PositionTypeMaster`,e)}updatePositionType(e,n){return this.http.put(`${this.baseUrl}/PositionTypeMaster/${e}`,n)}loadPositionType(){return this.http.get(`${this.baseUrl}/PositionTypeMaster`)}loadPositionTypeById(e){return this.http.get(`${this.baseUrl}/PositionTypeMaster/${e}`)}deletePositionType(e){return this.http.delete(`${this.baseUrl}/PositionTypeMaster/${e}`)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(G.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Y=l(7185),g=l(5727),M=l(6142),F=l(559);const w=["mat-button",""],I=["*"],V=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class X{constructor(i){this._elementRef=i}}const j=(0,g.pj)((0,g.Id)((0,g.Kr)(X)));let J=(()=>{class o extends j{constructor(e,n,a,s){super(e),this._focusMonitor=a,this._animationMode=s,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const r of V)this._hasHostAttributes(r)&&e.nativeElement.classList.add(r);this._focusMonitor.monitor(this._elementRef,!0),this.isRoundButton&&(this.color="accent")}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(){this._getHostElement().focus()}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...e){return e.some(n=>this._getHostElement().hasAttribute(n))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq),t.Y36(M.t4),t.Y36(F.tE),t.Y36(t.QbO,8))},o.\u0275cmp=t.Xpm({type:o,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(e,n){if(1&e&&t.Gf(g.wG,5),2&e){let a;t.iGM(a=t.CRH())&&(n.ripple=a.first)}},hostVars:3,hostBindings:function(e,n){2&e&&(t.Ikx("disabled",n.disabled||null),t.ekj("_mat-animation-noopable","NoopAnimations"===n._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[t.qOj],attrs:w,ngContentSelectors:I,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(e,n){1&e&&(t.F$t(),t.TgZ(0,"span",0),t.Hsn(1),t.qZA(),t._UZ(2,"div",1)(3,"div",2)),2&e&&(t.xp6(2),t.ekj("mat-button-ripple-round",n.isRoundButton||n.isIconButton),t.Q6J("matRippleDisabled",n._isRippleDisabled())("matRippleCentered",n.isIconButton)("matRippleTrigger",n._getHostElement()))},dependencies:[g.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media (hover:none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-flat-button,.mat-icon-button,.mat-stroked-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-flat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-focus-overlay,.mat-stroked-button .mat-button-ripple.mat-ripple{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button .mat-icon,.mat-icon-button i{line-height:24px}.mat-button-focus-overlay,.mat-button-ripple.mat-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-focus-overlay{opacity:0;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}@media (-ms-high-contrast:active){.mat-button-focus-overlay{background-color:#fff}}@media (-ms-high-contrast:black-on-white){.mat-button-focus-overlay{background-color:#000}}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}@media (-ms-high-contrast:active){.mat-button,.mat-fab,.mat-flat-button,.mat-icon-button,.mat-mini-fab,.mat-raised-button{outline:solid 1px}}"],encapsulation:2,changeDetection:0}),o})(),$=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[y.ez,g.si,g.BQ,g.BQ]}),o})();var B=l(6909),Z=l(4151),k=l(3390);let K=(()=>{class o{constructor(){this.isReady=!1,this.gameInstanceEvent=new t.vpe}ngOnDestroy(){}ngOnInit(){const e=window.UnityLoader;this.unityInstance=e.instantiate("unityContainer","assets/positionType/Build/positionType.json",{onProgress:(n,a)=>{this.isReady=!0,this.localGameInstance=n,this.gameInstanceEvent.emit({gameInstance:this.localGameInstance}),this.localGameInstance.SendMessage("EventManager","HandleKeyboard","false")}})}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-unity-view"]],outputs:{gameInstanceEvent:"gameInstanceEvent"},decls:1,vars:0,consts:[["id","unityContainer",1,"unity-container"]],template:function(e,n){1&e&&t._UZ(0,"div",0)}}),o})();function W(o,i){1&o&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Total Height (m)"),t.qZA(),t._UZ(3,"input",19),t.qZA())}function tt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"mat-form-field")(2,"mat-label"),t._uU(3),t.qZA(),t.TgZ(4,"input",25),t.NdJ("change",function(a){const r=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.setLayerHeight(r.uuid,a))}),t.qZA()()()}if(2&o){const e=i.$implicit;t.xp6(3),t.hij("",e.layerDescription," Height (m)"),t.xp6(1),t.s9C("value",e.totalHeight)}}function et(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"h3"),t._uU(2,"Levels"),t.qZA(),t.TgZ(3,"mat-form-field")(4,"mat-label"),t._uU(5,"Ground Offset (m)"),t.qZA(),t.TgZ(6,"input",20),t.NdJ("change",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onOffsetValueChange(a))}),t.qZA()(),t.TgZ(7,"mat-form-field",3)(8,"mat-label"),t._uU(9,"Level"),t.qZA(),t.TgZ(10,"mat-select",21),t.NdJ("valueChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onLevelValueChange(a))})("valueChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.actualLayerCount=a)}),t.TgZ(11,"mat-option",22),t._uU(12,"1"),t.qZA(),t.TgZ(13,"mat-option",22),t._uU(14,"2"),t.qZA(),t.TgZ(15,"mat-option",22),t._uU(16,"3"),t.qZA(),t.TgZ(17,"mat-option",22),t._uU(18,"4"),t.qZA(),t.TgZ(19,"mat-option",22),t._uU(20,"5"),t.qZA(),t.TgZ(21,"mat-option",22),t._uU(22,"6"),t.qZA(),t.TgZ(23,"mat-option",22),t._uU(24,"7"),t.qZA(),t.TgZ(25,"mat-option",22),t._uU(26,"8"),t.qZA(),t.TgZ(27,"mat-option",22),t._uU(28,"9"),t.qZA(),t.TgZ(29,"mat-option",22),t._uU(30,"10"),t.qZA(),t.TgZ(31,"mat-option",22),t._uU(32,"11"),t.qZA(),t.TgZ(33,"mat-option",22),t._uU(34,"12"),t.qZA(),t.TgZ(35,"mat-option",22),t._uU(36,"13"),t.qZA(),t.TgZ(37,"mat-option",22),t._uU(38,"14"),t.qZA(),t.TgZ(39,"mat-option",22),t._uU(40,"15"),t.qZA(),t.TgZ(41,"mat-option",22),t._uU(42,"16"),t.qZA(),t.TgZ(43,"mat-option",22),t._uU(44,"17"),t.qZA(),t.TgZ(45,"mat-option",22),t._uU(46,"18"),t.qZA(),t.TgZ(47,"mat-option",22),t._uU(48,"19"),t.qZA(),t.TgZ(49,"mat-option",22),t._uU(50,"20"),t.qZA()()(),t.TgZ(51,"div",23),t.YNc(52,tt,5,2,"div",24),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("value",e.layerGroundOffset.toString()),t.xp6(4),t.Q6J("value",e.actualLayerCount),t.xp6(1),t.Q6J("value",1),t.xp6(2),t.Q6J("value",2),t.xp6(2),t.Q6J("value",3),t.xp6(2),t.Q6J("value",4),t.xp6(2),t.Q6J("value",5),t.xp6(2),t.Q6J("value",6),t.xp6(2),t.Q6J("value",7),t.xp6(2),t.Q6J("value",8),t.xp6(2),t.Q6J("value",9),t.xp6(2),t.Q6J("value",10),t.xp6(2),t.Q6J("value",11),t.xp6(2),t.Q6J("value",12),t.xp6(2),t.Q6J("value",13),t.xp6(2),t.Q6J("value",14),t.xp6(2),t.Q6J("value",15),t.xp6(2),t.Q6J("value",16),t.xp6(2),t.Q6J("value",17),t.xp6(2),t.Q6J("value",18),t.xp6(2),t.Q6J("value",19),t.xp6(2),t.Q6J("value",20),t.xp6(3),t.Q6J("ngForOf",e.layers)}}function ot(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",30)(1,"mat-form-field",31)(2,"mat-label"),t._uU(3),t.qZA(),t.TgZ(4,"input",25),t.NdJ("change",function(a){const r=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.setBinFront(r.uuid,a))}),t.qZA()()()}if(2&o){const e=i.$implicit,n=t.oxw(2);t.xp6(3),t.hij("",e.binDescription," Front (m)"),t.xp6(1),t.s9C("value",e.totalFront+n.binSeparationOffset)}}function nt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",26)(1,"h4"),t._uU(2,"Rows"),t.qZA(),t.TgZ(3,"div")(4,"mat-form-field",3)(5,"mat-label"),t._uU(6,"Rows"),t.qZA(),t.TgZ(7,"mat-select",21),t.NdJ("valueChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onBinValueChange(a))})("valueChange",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.actualBinCount=a)}),t.TgZ(8,"mat-option",22),t._uU(9,"1"),t.qZA(),t.TgZ(10,"mat-option",22),t._uU(11,"2"),t.qZA(),t.TgZ(12,"mat-option",22),t._uU(13,"3"),t.qZA(),t.TgZ(14,"mat-option",22),t._uU(15,"4"),t.qZA(),t.TgZ(16,"mat-option",22),t._uU(17,"5"),t.qZA(),t.TgZ(18,"mat-option",22),t._uU(19,"6"),t.qZA(),t.TgZ(20,"mat-option",22),t._uU(21,"7"),t.qZA(),t.TgZ(22,"mat-option",22),t._uU(23,"8"),t.qZA(),t.TgZ(24,"mat-option",22),t._uU(25,"9"),t.qZA(),t.TgZ(26,"mat-option",22),t._uU(27,"10"),t.qZA(),t.TgZ(28,"mat-option",22),t._uU(29,"11"),t.qZA(),t.TgZ(30,"mat-option",22),t._uU(31,"12"),t.qZA(),t.TgZ(32,"mat-option",22),t._uU(33,"13"),t.qZA(),t.TgZ(34,"mat-option",22),t._uU(35,"14"),t.qZA(),t.TgZ(36,"mat-option",22),t._uU(37,"15"),t.qZA(),t.TgZ(38,"mat-option",22),t._uU(39,"16"),t.qZA(),t.TgZ(40,"mat-option",22),t._uU(41,"17"),t.qZA(),t.TgZ(42,"mat-option",22),t._uU(43,"18"),t.qZA(),t.TgZ(44,"mat-option",22),t._uU(45,"19"),t.qZA(),t.TgZ(46,"mat-option",22),t._uU(47,"20"),t.qZA()()(),t.TgZ(48,"mat-form-field",27)(49,"mat-label"),t._uU(50,"Bin Separtion (m)"),t.qZA(),t.TgZ(51,"input",20),t.NdJ("change",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onBinSparationValue(a))}),t.qZA()()(),t.TgZ(52,"div",28),t.YNc(53,ot,5,2,"div",29),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(7),t.Q6J("value",e.actualBinCount),t.xp6(1),t.Q6J("value",1),t.xp6(2),t.Q6J("value",2),t.xp6(2),t.Q6J("value",3),t.xp6(2),t.Q6J("value",4),t.xp6(2),t.Q6J("value",5),t.xp6(2),t.Q6J("value",6),t.xp6(2),t.Q6J("value",7),t.xp6(2),t.Q6J("value",8),t.xp6(2),t.Q6J("value",9),t.xp6(2),t.Q6J("value",10),t.xp6(2),t.Q6J("value",11),t.xp6(2),t.Q6J("value",12),t.xp6(2),t.Q6J("value",13),t.xp6(2),t.Q6J("value",14),t.xp6(2),t.Q6J("value",15),t.xp6(2),t.Q6J("value",16),t.xp6(2),t.Q6J("value",17),t.xp6(2),t.Q6J("value",18),t.xp6(2),t.Q6J("value",19),t.xp6(2),t.Q6J("value",20),t.xp6(5),t.Q6J("value",e.binSeparationOffset.toString()),t.xp6(2),t.Q6J("ngForOf",e.bins)}}let q=(()=>{class o{constructor(e,n,a,s){this.route=e,this.typeAddressService=n,this.activeRoute=a,this.toastr=s,this.layers=[],this.bins=[],this.layerGroundOffset=0,this.binSeparationOffset=0,this.actualLayerCount=0,this.actualBinCount=0,this.selectedType="floor",this.unitSystem="m",this.gameInstanceSubject=new H.x,this.gameInstance$=this.gameInstanceSubject.asObservable(),this.subscription=this.gameInstance$.subscribe(()=>{this.gameInstance.SendMessage("EventManager","SelectPositionTypePrefab",this.selectedType),-1!==this.id&&this.typeAddressService.loadPositionTypeById(this.id).subscribe(r=>{this.typeForm.patchValue(r),this.typeForm.get("positionColor").setValue("#"+r.positionColor.toString(16)),this.positionType=r,this.layers=r.layers,this.bins=r.layers[0].bins,this.actualLayerCount=this.layers.length,this.actualBinCount=this.bins.length,"floor"!==this.positionType.type&&(this.layerGroundOffset=this.layers[0].locationY,this.loadLayers()),"bin"===this.positionType.type&&(this.binSeparationOffset=this.bins[0].locationZ,this.loadBins())})}),this.id=-1}ngOnDestroy(){this.subscription.unsubscribe()}ngOnInit(){this.initForm();const e=this.activeRoute.snapshot.paramMap.get("id");e&&(this.id=parseInt(e))}setLayerAndBinToFloor(e){this.bins.push({binDescription:"B01",totalFront:1,totalHeight:1.3,totalDepth:1.2,angle:0,locationX:0,locationY:0,locationZ:0,images:[],products:[]}),this.layers.push({layerDescription:"L01",totalFront:e.totalFront,totalHeight:e.totalHeight,totalDepth:e.totalDepth,locationX:0,locationY:0,locationZ:0,bins:[]})}setBinsToRack(){this.bins.push({binDescription:"B01",totalFront:1,totalHeight:1.3,totalDepth:1.2,angle:0,locationX:0,locationY:0,locationZ:0,images:[],products:[]})}submit(){this.positionType=this.typeForm.value,this.positionType.positionColor=parseInt(this.typeForm.get("positionColor").value.toString().replace("#",""),16),"floor"===this.positionType.type?this.setLayerAndBinToFloor(this.positionType):"rack"===this.positionType.type?this.setBinsToRack():this.bins[0].locationZ=this.binSeparationOffset,this.layers.forEach(e=>{e.bins=this.bins}),this.positionType.layers=this.layers,-1===this.id?this.typeAddressService.savePositionType(this.positionType).subscribe({complete:()=>{this.route.navigate(["typeaddress"])},error:e=>console.error(e)}):this.typeAddressService.updatePositionType(this.id,this.positionType).subscribe({complete:()=>{this.route.navigate(["typeaddress"])},error:e=>console.error(e)})}initForm(){this.typeForm=new d.cw({type:new d.NI(this.selectedType,[d.kI.required]),positionTypeDescription:new d.NI("",[d.kI.required]),totalFront:new d.NI("1.0",[d.kI.required]),totalDepth:new d.NI("1.0",[d.kI.required]),totalHeight:new d.NI("1.0",[d.kI.required]),positionColor:new d.NI("#000000",[d.kI.required])}),this.typeForm.get("type")?.valueChanges.subscribe(e=>{this.selectedType=e,this.layers=[],this.bins=[],this.layerGroundOffset=0,this.resetLayers(),this.gameInstance.SendMessage("EventManager","SelectPositionTypePrefab",this.selectedType)}),this.typeForm.get("totalHeight")?.valueChanges.subscribe(e=>{const n={axis:1,amount:e};this.resetLayers(),this.gameInstance.SendMessage("EventManager","HandleResizeVisualization",JSON.stringify(n)),this.onLevelValueChange(this.actualLayerCount)}),this.typeForm.get("totalDepth")?.valueChanges.subscribe(e=>{const n={axis:2,amount:e};this.resetLayers(),this.gameInstance.SendMessage("EventManager","HandleResizeVisualization",JSON.stringify(n)),this.onLevelValueChange(this.actualLayerCount)}),this.typeForm.get("totalFront")?.valueChanges.subscribe(e=>{const n={axis:0,amount:e};this.resetLayers(),this.gameInstance.SendMessage("EventManager","HandleResizeVisualization",JSON.stringify(n)),this.onLevelValueChange(this.actualLayerCount)})}onLevelValueChange(e){this.gameInstance.SendMessage("EventManager","RemoveLayers"),this.gameInstance.SendMessage("EventManager","RemoveBins"),this.layers=[];const n=parseFloat(this.typeForm.get("totalFront")?.value),a=parseFloat(this.typeForm.get("totalDepth")?.value),s=parseFloat(this.typeForm.get("totalHeight")?.value),r=parseFloat(((s-this.layerGroundOffset)/e).toFixed(2));let p=this.layerGroundOffset;for(let b=0;b<e;b++)this.layers.push({bins:[],layerDescription:`L${b}`,locationX:0,locationY:p,locationZ:0,totalDepth:a,totalFront:n,totalHeight:r,uuid:U()}),this.gameInstance.SendMessage("EventManager","AddLayer",p.toString()),p+=r}setLayerHeight(e,n){const a=this.layers.findIndex(m=>m.uuid===e),s=this.layers[a];s.totalHeight=parseFloat(n.target.value);let r=this.layerGroundOffset;for(let m=0;m<a;m++){const u=this.layers[m];r+=u.locationY+u.totalHeight}s.locationY=r,r+=s.totalHeight;const p=parseFloat(this.typeForm.get("totalHeight")?.value),b=parseFloat(((p-r)/(this.layers.length-1-a)).toFixed(2));for(let m=a+1;m<this.layers.length;m++){const u=this.layers[m];u.locationY=r,u.totalHeight=b,r+=b}this.gameInstance.SendMessage("EventManager","RemoveLayers"),this.layers.forEach(m=>{this.gameInstance.SendMessage("EventManager","AddLayer",m.locationY.toString())})}onBinValueChange(e){this.bins=[],this.gameInstance.SendMessage("EventManager","RemoveBins");const n=parseFloat(this.typeForm.get("totalFront")?.value),a=parseFloat(this.typeForm.get("totalDepth")?.value),s=parseFloat((n/e).toFixed(2));let r=0;for(let p=0;p<e;p++)this.bins.push({totalHeight:.05,totalFront:s-this.binSeparationOffset,totalDepth:a,binDescription:`B${p}`,angle:0,images:[],products:[],locationX:r,locationY:0,locationZ:0,uuid:U()}),this.gameInstance.SendMessage("EventManager","HandleAddBin",JSON.stringify({locationX:r,totalFront:s-this.binSeparationOffset})),r+=s}setBinFront(e,n){const a=parseFloat(n.target.value),s=this.bins.findIndex(u=>u.uuid===e),r=this.bins[s];if(a<=this.binSeparationOffset)return this.toastr.warning("Size need to be bigger then separion offset size!"),void(n.target.value=r.totalFront+this.binSeparationOffset);r.totalFront=a-this.binSeparationOffset;let p=0;for(let u=0;u<s;u++){const v=this.bins[u];p+=v.locationX+v.totalFront+this.binSeparationOffset}r.locationX=p,p+=r.totalFront+this.binSeparationOffset;const b=parseFloat(this.typeForm.get("totalFront")?.value),m=parseFloat(((b-p)/(this.bins.length-1-s)).toFixed(2));for(let u=s+1;u<this.bins.length;u++){const v=this.bins[u];v.locationX=p,v.totalFront=m-this.binSeparationOffset,p+=m}this.gameInstance.SendMessage("EventManager","RemoveBins"),this.bins.forEach(u=>{this.gameInstance.SendMessage("EventManager","HandleAddBin",JSON.stringify({locationX:u.locationX,totalFront:u.totalFront}))})}onOffsetValueChange(e){const n=parseFloat(e.target.value);this.layerGroundOffset=n,this.resetLayers(),this.onLevelValueChange(this.actualLayerCount)}onBinSparationValue(e){const n=parseFloat(e.target.value);this.binSeparationOffset=n,this.gameInstance.SendMessage("EventManager","RemoveBins"),this.actualBinCount=0,this.bins=[]}setGameInstance(e){this.gameInstance=e.gameInstance,this.gameInstanceSubject.next(this.gameInstance)}loadLayers(){this.layers.forEach(e=>{this.gameInstance.SendMessage("EventManager","AddLayer",e.locationY.toString())})}loadBins(){this.bins.forEach(e=>{this.gameInstance.SendMessage("EventManager","HandleAddBin",JSON.stringify({locationX:e.locationX,totalFront:e.totalFront}))})}resetLayers(){this.gameInstance.SendMessage("EventManager","RemoveLayers"),this.gameInstance.SendMessage("EventManager","RemoveBins"),this.actualLayerCount=0,this.actualBinCount=0}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(f.F0),t.Y36(x),t.Y36(f.gz),t.Y36(Y._W))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-type-address-create"]],decls:44,vars:6,consts:[[1,"grid-layout-divs"],[2,"margin-top","5%"],[3,"formGroup","ngSubmit"],["appearance","fill"],["formControlName","type"],["value","floor"],["value","rack"],["value","bin"],["matInput","","formControlName","positionTypeDescription"],["matInput","","formControlName","totalFront"],["matInput","","formControlName","totalDepth"],[4,"ngIf"],[2,"display","grid","grid-template-rows","50% 50%"],["type","color","formControlName","positionColor",2,"width","50%"],["mat-raised-button","","color","primary","type","submit"],[1,"levels",3,"ngClass"],[1,"view-bins"],[3,"gameInstanceEvent"],["class","bins",4,"ngIf"],["matInput","","formControlName","totalHeight"],["matInput","",3,"value","change"],[3,"value","valueChange"],[3,"value"],[2,"height","400px","overflow","auto"],[4,"ngFor","ngForOf"],["matInput","","type","number",3,"value","change"],[1,"bins"],[2,"margin-left","10px"],[2,"width","800px","overflow-x","auto","display","flex"],["style","margin-left: 0%",4,"ngFor","ngForOf"],[2,"margin-left","0%"],[2,"width","80%"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div")(2,"h3"),t._uU(3,"Type Address"),t.qZA(),t.TgZ(4,"div",1)(5,"form",2),t.NdJ("ngSubmit",function(){return n.submit()}),t.TgZ(6,"mat-form-field",3)(7,"mat-label"),t._uU(8,"Type"),t.qZA(),t.TgZ(9,"mat-select",4)(10,"mat-option",5),t._uU(11,"Floor"),t.qZA(),t.TgZ(12,"mat-option",6),t._uU(13,"Rack"),t.qZA(),t.TgZ(14,"mat-option",7),t._uU(15,"Bin"),t.qZA()()(),t.TgZ(16,"mat-form-field")(17,"mat-label"),t._uU(18,"Description"),t.qZA(),t._UZ(19,"input",8),t.qZA(),t.TgZ(20,"mat-form-field")(21,"mat-label"),t._uU(22),t.qZA(),t._UZ(23,"input",9),t.qZA(),t.TgZ(24,"mat-form-field")(25,"mat-label"),t._uU(26,"Total Depth (m)"),t.qZA(),t._UZ(27,"input",10),t.qZA(),t.YNc(28,W,4,0,"mat-form-field",11),t.TgZ(29,"div",12)(30,"mat-label"),t._uU(31,"Color"),t.qZA(),t._UZ(32,"input",13),t.qZA(),t.TgZ(33,"div",1)(34,"button",14),t._uU(35,"Save"),t.qZA()()()()(),t.TgZ(36,"div",15),t.YNc(37,et,53,23,"div",11),t.qZA(),t.TgZ(38,"div",16)(39,"div")(40,"h3"),t._uU(41,"View"),t.qZA(),t.TgZ(42,"app-unity-view",17),t.NdJ("gameInstanceEvent",function(s){return n.setGameInstance(s)}),t.qZA()(),t.YNc(43,nt,54,23,"div",18),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("formGroup",n.typeForm),t.xp6(17),t.hij("Total Front (",n.unitSystem,")"),t.xp6(6),t.Q6J("ngIf","floor"!==n.selectedType),t.xp6(8),t.Q6J("ngClass","floor"!==n.selectedType?"border-lightgray":""),t.xp6(1),t.Q6J("ngIf","floor"!==n.selectedType),t.xp6(6),t.Q6J("ngIf","bin"===n.selectedType))},dependencies:[y.mk,y.sg,y.O5,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,J,Z.KE,Z.hX,k.Nt,B.gD,g.ey,K],styles:[".grid-layout-divs[_ngcontent-%COMP%]{display:grid;grid-template-columns:20% 15% 50%;grid-template-rows:90vh;column-gap:10px;margin:.5%;padding:0% 2%}.levels[_ngcontent-%COMP%]{margin-top:5%;padding:4%;border-radius:10px}.view-bins[_ngcontent-%COMP%]{margin-top:2.8%;display:grid;grid-template-rows:75% 25%}.bins[_ngcontent-%COMP%]{border:.1px solid lightgray;border-radius:10px;padding-left:5%;padding-top:1%}.border-lightgray[_ngcontent-%COMP%]{border:1px solid lightgray}"]}),o})();var Q=l(5861),D=l(3905),R=l(4995),h=l(4943);let it=(()=>{class o{constructor(e,n){this.typeAddressService=e,this.route=n,this.positionType=[]}ngOnInit(){this.onDelete=this.onDelete.bind(this),this.onUpdate=this.onUpdate.bind(this)}onUpdate(e){this.route.navigate(["typeaddress/update",e.row.data.id])}onDelete(e){var n=this;return(0,Q.Z)(function*(){const s=e.component.deleteRow(e.row.rowIndex);console.log(s);const r=e.row.data.id;try{yield(0,D.z)(n.typeAddressService.deletePositionType(r))}catch(p){console.error("Error ",p)}})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x),t.Y36(f.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-type-address-grid"]],inputs:{positionType:"positionType"},decls:19,vars:10,consts:[[2,"margin-top","3%","border","1px solid lightgray","padding","2%","border-radius","2%"],["id","gridContainerPostionType","height","clamp(400px, 700px, 900px)",1,"dx-rounded-borders",3,"dataSource","showBorders","allowColumnReordering","allowColumnResizing"],["mode","virtual"],[3,"visible"],[3,"pageSize"],["mode","none"],["mode","single"],["mode","popup"],["confirmDeleteMessage",""],["dataField","type","caption","Type"],["dataField","positionTypeDescription","caption","Description"],["dataField","totalFront","caption","Front (m)"],["dataField","totalDepth","caption","Depth (m)"],["dataField","totalHeight","caption","Height (m)"],["dataField","positionColor","caption","Color"],["type","buttons","caption","Actions",3,"width"],["icon","edit",3,"onClick"],["icon","trash",3,"onClick"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"dx-data-grid",1),t._UZ(2,"dxo-scrolling",2)(3,"dxo-search-panel",3)(4,"dxo-paging",4)(5,"dxo-group-panel",3)(6,"dxo-sorting",5)(7,"dxo-selection",6),t.TgZ(8,"dxo-editing",7),t._UZ(9,"dxo-texts",8),t.qZA(),t._UZ(10,"dxi-column",9)(11,"dxi-column",10)(12,"dxi-column",11)(13,"dxi-column",12)(14,"dxi-column",13)(15,"dxi-column",14),t.TgZ(16,"dxi-column",15),t._UZ(17,"dxi-button",16)(18,"dxi-button",17),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("dataSource",n.positionType)("showBorders",!0)("allowColumnReordering",!0)("allowColumnResizing",!0),t.xp6(2),t.Q6J("visible",!0),t.xp6(1),t.Q6J("pageSize",10),t.xp6(1),t.Q6J("visible",!0),t.xp6(11),t.Q6J("width",110),t.xp6(1),t.Q6J("onClick",n.onUpdate),t.xp6(1),t.Q6J("onClick",n.onDelete))},dependencies:[R.e,h.u10,h.qvW,h.k4o,h.Uo8,h.Een,h.sXh,h.PXJ,h.XXE,h.Lz9,h.SWO],changeDetection:0}),o})();const at=[{path:"",component:(()=>{class o{constructor(e){this.typeAddressService=e,this.positionType=[]}ngOnInit(){this.loadPositionType()}loadPositionType(){var e=this;return(0,Q.Z)(function*(){try{e.positionType=yield(0,D.z)(e.typeAddressService.loadPositionType()),console.info(e.positionType)}catch(n){console.log(n)}})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-type-address"]],decls:8,vars:1,consts:[[1,"container"],[2,"margin-top","2%"],["tabindex","0","routerLink","create",1,"large","ui","vertical","animated","button","primary"],[1,"hidden","content"],[1,"visible","content"],[1,"plus","icon"],[3,"positionType"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._uU(4,"Add"),t.qZA(),t.TgZ(5,"div",4),t._UZ(6,"i",5),t.qZA()()(),t._UZ(7,"app-type-address-grid",6),t.qZA()),2&e&&(t.xp6(7),t.Q6J("positionType",n.positionType))},dependencies:[f.rH,it],styles:[".mat-focused .mat-form-field-label{color:green!important}  .mat-form-field-underline{background-color:green!important}  .mat-form-field-ripple{background-color:green!important}"]}),o})()},{path:"create",component:q},{path:"update/:id",component:q}];let st=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[f.Bz.forChild(at),f.Bz]}),o})();var rt=l(7217),lt=l(5349),pt=l(2643);let dt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[x,{provide:Z.o2,useValue:{appearance:"outline"}}],imports:[y.ez,st,lt.m,R.x,O.XD,rt.ie,$,pt.Ps,Z.lN,k.c,B.LD]}),o})()}}]);