using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Core.Dtos.PositionType;
using Core.Entities;
using Core.Interfaces.Services;
using Microsoft.AspNetCore.Mvc;

namespace API.Controllers;

public class PositionTypeMasterController : BaseController
{
    private readonly IPositionTypeMasterService _positionTypeMasterService;

    public PositionTypeMasterController(IPositionTypeMasterService positionTypeMasterService)
    {
        _positionTypeMasterService = positionTypeMasterService;
    }

    [HttpGet]
    public async Task<IReadOnlyList<PositionTypeMasterDto>> LoadPositionTypeMaster()
    {
        return await _positionTypeMasterService.LoadAllData();
    }

    [HttpGet("{id}")]
    public async Task<PositionTypeMasterDto> LoadPositionTypeMasterById(int id)
    {
        return await _positionTypeMasterService.LoadPositionTypeMasterByIdAsync(id);
    }


    [HttpPost]
    public async Task<ActionResult> RegisterPositionType(PositionTypeMasterDto positionType)
    {
        var res = await _positionTypeMasterService.SavePositionTypeAsync(positionType);
        if (res)
            return Ok();
        return BadRequest("Failed to save position type.");

    }

    [HttpPut("{id}")]
    public async Task<ActionResult> UpdatePositionType(int id, PositionTypeMasterDto positionType)
    {
        var res = await _positionTypeMasterService.UpdatePositionTypeAsync(id, positionType);
        if (res)
            return Ok();
        return BadRequest("Failed to update position type");
    }

    [HttpDelete("{id}")]
    public async Task<ActionResult> DeletePositionType(int id)
    {
        var res = await _positionTypeMasterService.DeletePositionTypeAsync(id);
        if (res)
            return Ok();
        return BadRequest("Failed to delete position type.");
    }
}
